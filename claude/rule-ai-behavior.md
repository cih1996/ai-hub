文件操作规范（重要）
- 操作全局规则（rules/）、笔记（notes/）时，必须调用「一号笔记管理」Skill 通过 API 操作
- 操作知识库（knowledge/）、记忆库（memory/）时，必须调用「向量知识库」Skill 通过 API 操作
- 严禁直接用 Edit/Write 工具修改 {{CLAUDE_DIR}}/ 下的这些文件，因为它们由 AI Hub 管理（Read/Grep 可直接使用）
- 项目级规则（{workDir}/.claude/）不受此限制，可直接 Read/Edit

执行准则
- 接收任务后自主执行，优先检索知识库，无需逐步请示用户
- 严禁无事实根据的猜测，不确定时先查证再行动
- 执行失败允许自动重试，3 次仍失败方可向用户求助
- 任务完成后必须提供成功/失败证明（文件存在、进程回显等），简洁汇报核心结果
- 严禁直接运行 ai-hub 二进制。创建子任务必须通过 HTTP API（POST /api/v1/chat/send）创建新会话
- 多角色协作：参考"一号智能体"技能手册调用 API，所有子角色指定同一 work_dir，在该目录 .claude/CLAUDE.md 写入项目级规则（角色分工、通信协议、记忆规范）

任务前检索（强制）
- 每次接到新任务时，必须先通过「向量知识库」Skill 搜索相关知识和记忆
- 搜索关键词应覆盖：任务涉及的技术点、工具名称、项目名称
- 搜索结果中相似度高的文件必须 read 完整内容后再开始工作
- 特别是涉及 MCP、Chrome、测试、部署等操作时，必须先搜索是否有踩坑记录
- 如果搜索到相关纠错记录或操作指南，必须严格遵循，不得重复踩坑

上下文恢复准则
- 上下文压缩后，第一步必须搜索记忆库恢复工作状态
- 搜索关键词：当前任务名称、项目名称、最近操作
- 恢复后简要总结之前的工作进度，然后继续执行

自主纠错 (Error Recovery)
- 遇到常规性错误并解决后，通过「一号笔记管理」Skill 在 {{RULES_DIR}} 生成子规则（单文件），记录"避免 X，改用 Y"
- 内置已知问题：WebFetch 无法访问内网地址 → 改用 curl
- 遇到新问题时，先通过「向量知识库」Skill 搜索已有规则和知识，避免重复踩坑

自主产出子规则 (Auto Rules)
子规则命名：rule-<简短描述>.md
- 通过「一号笔记管理」Skill 创建，禁止直接写文件
- 发现项目缺少文档、需自行搜索或读代码才能理解时，生成子规则

Skill 调用强化 (Skill Trigger Reinforcement)
若因疏忽忘记调用 Skill，用户主动强调后，必须在 {{RULES_DIR}} 新增子规则（rule-skill-<名称>.md），强化触发条件，确保后续不再遗漏。
